# Git 统计邮件功能 - 使用指南

## ✅ 功能已实现

Git 统计邮件发送功能已成功集成到 PandaCoder 插件中！

---

## 📋 实现清单

✅ **核心功能**
- [x] 添加 JavaMail 依赖
- [x] 邮件数据模型（Config, Content, Record）
- [x] 密码加密工具
- [x] 邮件模板服务（HTML + 文本）
- [x] 核心邮件服务
- [x] 配置持久化
- [x] UI 界面集成
- [x] plugin.xml 服务注册

---

## 🚀 使用步骤

### 第一步：同步 Gradle 依赖

在使用邮件功能之前，需要先同步 Gradle 依赖：

```bash
# 在项目根目录执行
./gradlew build --refresh-dependencies

# 或者在 IntelliJ IDEA 中
# 点击 Gradle 面板的刷新按钮 🔄
```

### 第二步：访问邮件报告界面

1. 打开 IntelliJ IDEA
2. 在右侧工具栏找到 **Git 统计** 工具窗口
3. 切换到 **📧 邮件报告** 标签页

### 第三步：配置 SMTP 服务器

根据您使用的邮箱服务商，配置对应的 SMTP 信息：

#### Gmail 配置

```
SMTP服务器: smtp.gmail.com
端口: 587
启用 TLS: ✅
启用 SSL: ☐
发送者邮箱: your@gmail.com
SMTP密码: [应用专用密码]
接收者邮箱: recipient@email.com
```

> **重要**: Gmail 需要生成应用专用密码
> 1. 访问 https://myaccount.google.com/security
> 2. 开启两步验证
> 3. 生成应用专用密码

#### QQ 邮箱配置

```
SMTP服务器: smtp.qq.com
端口: 587
启用 TLS: ✅
启用 SSL: ☐
发送者邮箱: your@qq.com
SMTP密码: [授权码]
接收者邮箱: recipient@email.com
```

> **重要**: QQ 邮箱需要生成授权码
> 1. 登录 QQ 邮箱网页版
> 2. 设置 -> 账户 -> 开启 SMTP 服务
> 3. 生成授权码（不是 QQ 密码）

#### 163 邮箱配置

```
SMTP服务器: smtp.163.com
端口: 465
启用 TLS: ☐
启用 SSL: ✅
发送者邮箱: your@163.com
SMTP密码: [客户端授权密码]
接收者邮箱: recipient@email.com
```

### 第四步：测试连接

1. 填写完 SMTP 配置后
2. 点击 **测试连接** 按钮
3. 确认连接成功提示

### 第五步：配置定时发送（可选）

如果需要每日自动发送统计邮件：

1. 勾选 **启用每日定时发送**
2. 设置发送时间（例如：18:00）
3. 选择筛选作者（留空表示所有开发者）
4. 勾选 **包含趋势分析**（可选）
5. 点击 **应用定时设置**

### 第六步：手动发送测试

1. 点击 **📧 发送今日统计** 或 **📧 发送昨日统计**
2. 检查邮箱是否收到邮件

---

## 📧 邮件内容示例

### HTML 邮件效果

邮件将包含以下内容：

```
┌─────────────────────────────────────────┐
│         📊 Git 统计日报                  │
│     2025-10-22 | 张三                    │
│                                          │
│  🎯 今日概览                             │
│  ┌──────────────────────────────────┐  │
│  │  提交次数    新增代码    删除代码  │  │
│  │     12       +450       -120      │  │
│  │                                    │  │
│  │      净变化: +330 行               │  │
│  └──────────────────────────────────┘  │
│                                          │
│  📈 近7天趋势                            │
│  [柱状图展示]                            │
│                                          │
│  🏆 统计排名                             │
│  提交排名: 第 2 名 | 代码量排名: 第 1 名 │
│                                          │
└─────────────────────────────────────────┘
```

---

## 🔧 功能说明

### SMTP 配置

- **SMTP服务器**: 邮箱服务商的 SMTP 服务器地址
- **端口**: 通常为 587（TLS）或 465（SSL）
- **启用 TLS**: 使用 TLS 加密传输
- **启用 SSL**: 使用 SSL 加密传输
- **SMTP密码**: 加密存储在本地配置文件中

### 定时发送

- 每天定时发送昨日统计
- 支持自定义发送时间
- 可筛选特定作者或统计所有开发者
- 自动包含 7 天趋势分析

### 手动发送

- **发送今日统计**: 发送当天的代码统计
- **发送昨日统计**: 发送昨天的代码统计

### 发送历史

- 记录最近 100 条发送记录
- 显示发送时间、状态、统计数据
- 可查看发送成功或失败的详情

---

## 🔒 安全性

### 密码加密

- 所有 SMTP 密码都使用 AES 加密存储
- 基于项目路径生成唯一密钥
- 配置文件中只保存加密后的密码

### 网络安全

- 支持 TLS/SSL 加密传输
- 使用邮箱官方授权码机制
- 不会泄露您的主密码

---

## 💡 使用技巧

### 1. 个人日报

**场景**: 每天下班前收到自己的代码统计

```
配置:
- 筛选作者: [你的名字]
- 发送时间: 18:00
- 包含趋势: ✅
```

### 2. 团队周报

**场景**: 每周查看团队整体进度

```
配置:
- 筛选作者: (所有作者)
- 手动发送: 选择周五
- 包含趋势: ✅
```

### 3. 项目进度跟踪

**场景**: 监控项目开发进度

```
配置:
- 筛选作者: (所有作者)
- 定时发送: 每天 17:00
- 发送给: 项目经理邮箱
```

---

## ❓ 常见问题

### Q1: 测试连接失败怎么办？

**A**: 请检查：
1. SMTP 服务器地址和端口是否正确
2. 是否使用了授权码而不是登录密码
3. 网络连接是否正常
4. 防火墙是否阻止了连接

### Q2: 邮件发送失败？

**A**: 可能的原因：
1. SMTP 密码错误
2. 邮箱服务未开启 SMTP 服务
3. 网络问题
4. 接收邮箱地址错误

### Q3: 为什么没有收到定时邮件？

**A**: 请确认：
1. 定时任务已启用
2. IDE 保持运行（定时任务依赖 IDE 进程）
3. 配置已保存
4. 检查垃圾邮件文件夹

### Q4: 如何修改邮件主题？

**A**: 目前邮件主题是固定的格式：`📊 Git 统计日报 - {DATE}`
如需自定义，可在后续版本中添加配置选项。

### Q5: 可以发送给多个人吗？

**A**: 当前版本支持单个接收者。
如需发送给多人，可以配置邮箱转发规则。

---

## 🎯 下一步计划

以下功能计划在后续版本中实现：

- [ ] 支持多个接收者
- [ ] 自定义邮件模板
- [ ] 周报/月报功能
- [ ] 附件支持（CSV 导出）
- [ ] 钉钉/企业微信 Webhook 集成
- [ ] 更丰富的图表展示
- [ ] PDF 报告生成

---

## 📞 支持

如果遇到问题，可以：

1. 查看 [详细设计方案](./Git统计邮件发送功能设计方案.md)
2. 查看 [快速实施指南](./Git统计邮件发送功能-快速实施指南.md)
3. 查看插件日志文件
4. 联系作者获取支持

---

**版本**: 1.0  
**创建时间**: 2025-10-22  
**适用版本**: PandaCoder 2.0+

祝您使用愉快！🎉

