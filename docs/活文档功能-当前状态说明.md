# æ´»æ–‡æ¡£åŠŸèƒ½ - å½“å‰çŠ¶æ€è¯´æ˜

## âš ï¸ é‡è¦è¯´æ˜

**PandaCoder æ˜¯ä¸€ä¸ª IntelliJ IDEA æ’ä»¶é¡¹ç›®ï¼Œä¸èƒ½ä½¿ç”¨ Spring Boot å’Œ Spring AI æ¡†æ¶ã€‚**

ä¹‹å‰çš„å®ç°æ–¹æ¡ˆåŸºäº Spring AIï¼Œè¿™æ˜¯é”™è¯¯çš„ã€‚ç°åœ¨æ­£åœ¨è¿›è¡Œé‡æ„ã€‚

---

## ğŸ“Š å½“å‰çŠ¶æ€

### âœ… å·²å®Œæˆï¼ˆUI éƒ¨åˆ†ï¼‰

1. **æ’ä»¶é…ç½®ç³»ç»Ÿ**
   - âœ… `LivingDocSettings.java` - é…ç½®æŒä¹…åŒ–æœåŠ¡
   - âœ… `LivingDocConfigurable.java` - è®¾ç½®é¢æ¿ UI
   - âœ… æ”¯æŒ Gitee AI API Key é…ç½®
   - âœ… æ”¯æŒ Elasticsearch è¿æ¥é…ç½®

2. **å·¥å…·çª—å£**
   - âœ… `LivingDocToolWindowFactory.java` - å·¥å…·çª—å£å·¥å‚
   - âœ… `LivingDocToolWindowPanel.java` - å·¥å…·çª—å£é¢æ¿

3. **Actions æ“ä½œ**
   - âœ… `IndexProjectAction.java` - ç´¢å¼•é¡¹ç›®æ“ä½œ
   - âœ… `SearchDocAction.java` - æœç´¢æ–‡æ¡£æ“ä½œ
   - âœ… `ExportDocAction.java` - å¯¼å‡ºæ–‡æ¡£æ“ä½œ

4. **plugin.xml é…ç½®**
   - âœ… æ³¨å†Œäº†é…ç½®æœåŠ¡
   - âœ… æ³¨å†Œäº†è®¾ç½®é¢æ¿
   - âœ… æ³¨å†Œäº†å·¥å…·çª—å£
   - âœ… æ³¨å†Œäº† Actions èœå•

5. **å›¾æ ‡èµ„æº**
   - âœ… `livingdoc.svg` - ä¸»å›¾æ ‡
   - âœ… `search.svg` - æœç´¢å›¾æ ‡
   - âœ… `export.svg` - å¯¼å‡ºå›¾æ ‡

### âŒ å·²åˆ é™¤ï¼ˆSpring ç›¸å…³ï¼‰

ä»¥ä¸‹æ–‡ä»¶å› ä¸ºä¾èµ– Spring æ¡†æ¶è€Œè¢«åˆ é™¤ï¼š

1. **é…ç½®ç±»**
   - âŒ `LivingDocProperties.java` - Spring é…ç½®å±æ€§
   - âŒ `AiModelAutoConfiguration.java` - Spring AI è‡ªåŠ¨é…ç½®
   - âŒ `VectorStoreAutoConfiguration.java` - å‘é‡å­˜å‚¨è‡ªåŠ¨é…ç½®

2. **AI æ¨¡å‹**
   - âŒ `GiteeAiChatModel.java` - Spring AI é€‚é…å™¨
   - âŒ `GiteeAiEmbeddingModel.java` - Spring AI é€‚é…å™¨

3. **æ ¸å¿ƒæœåŠ¡**
   - âŒ `LivingDocRagService.java` - RAG æœåŠ¡
   - âŒ `SpringBootAnalyzer.java` - ä»£ç åˆ†æå™¨

4. **Elasticsearch å®ç°**
   - âŒ `ElasticsearchVectorStore.java` - æ—§ç‰ˆå®ç°

5. **æµ‹è¯•æ–‡ä»¶**
   - âŒ `GiteeAiIntegrationTest.java`
   - âŒ `RagServiceTest.java`

### âœ… ä¿ç•™ï¼ˆæ ¸å¿ƒæ¶æ„ï¼‰

1. **æ•°æ®æ¨¡å‹**
   - âœ… `VectorDocument.java` - å‘é‡æ–‡æ¡£æ¨¡å‹
   - âœ… `SearchResult.java` - æœç´¢ç»“æœæ¨¡å‹
   - âœ… `VectorStore.java` - å‘é‡å­˜å‚¨æ¥å£
   - âœ… `ElasticsearchVectorStore_8_15.java` - ES 8.15 å®ç°ï¼ˆéœ€ä¿®å¤ï¼‰

2. **åˆ†æå™¨æ¨¡å‹**
   - âœ… `ApiEndpoint.java` - API ç«¯ç‚¹æ¨¡å‹
   - âœ… `Parameter.java` - å‚æ•°æ¨¡å‹
   - âœ… `ResponseModel.java` - å“åº”æ¨¡å‹
   - âœ… `ProjectDocumentation.java` - é¡¹ç›®æ–‡æ¡£æ¨¡å‹
   - âœ… `EntityModel.java` - å®ä½“æ¨¡å‹

3. **ä¾èµ–é…ç½®**
   - âœ… Elasticsearch 8.15 ä¾èµ–
   - âœ… OkHttp å®¢æˆ·ç«¯ä¾èµ–

---

## ğŸ¯ é‡æ„æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šç®€åŒ–ç‰ˆï¼ˆæ¨èï¼‰

**ä¸ä½¿ç”¨ RAG å’Œ AI**ï¼Œåªå®ç°åŸºç¡€çš„æ–‡æ¡£ç”Ÿæˆå’Œç®¡ç†ï¼š

1. **ä»£ç åˆ†æ**
   - ä½¿ç”¨ IntelliJ PSI API åˆ†æ Java ä»£ç 
   - æå– API æ¥å£ä¿¡æ¯ï¼ˆControllerã€Service ç­‰ï¼‰
   - ç”Ÿæˆ Markdown/HTML æ–‡æ¡£

2. **æ–‡æ¡£ç®¡ç†**
   - ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶
   - æ”¯æŒå¯¼å‡ºå¤šç§æ ¼å¼
   - æ”¯æŒæœç´¢ï¼ˆåŸºäºæ–‡ä»¶å†…å®¹ï¼‰

3. **ä¼˜ç‚¹**
   - âœ… æ— éœ€å¤–éƒ¨ä¾èµ–ï¼ˆAIã€ESï¼‰
   - âœ… å®ç°ç®€å•ï¼Œç¨³å®šå¯é 
   - âœ… é€‚åˆ IDEA æ’ä»¶

### æ–¹æ¡ˆäºŒï¼šè½»é‡çº§ RAG

**ä½¿ç”¨ç®€å•çš„å‘é‡æœç´¢**ï¼Œä¸ä¾èµ– Spring AIï¼š

1. **AI é›†æˆ**
   - ç›´æ¥è°ƒç”¨ Gitee AI HTTP APIï¼ˆä½¿ç”¨ OkHttpï¼‰
   - è‡ªå·±å®ç° Embedding å’Œ Chat é€»è¾‘

2. **å‘é‡å­˜å‚¨**
   - ä½¿ç”¨ Elasticsearch 8.15
   - æˆ–è€…ä½¿ç”¨å†…å­˜å‘é‡åº“ï¼ˆå¦‚ [hnswlib-java](https://github.com/jelmerk/hnswlib)ï¼‰

3. **ä¼˜ç‚¹**
   - âœ… å®ç° RAG åŠŸèƒ½
   - âœ… ä¸ä¾èµ– Spring æ¡†æ¶
   - âŒ éœ€è¦è‡ªå·±å®ç° AI è°ƒç”¨é€»è¾‘

### æ–¹æ¡ˆä¸‰ï¼šæ··åˆæ–¹æ¡ˆ

**åŸºç¡€åŠŸèƒ½ + å¯é€‰ RAG**ï¼š

1. **æ ¸å¿ƒåŠŸèƒ½**ï¼ˆå¿…é¡»ï¼‰
   - ä»£ç åˆ†æå’Œæ–‡æ¡£ç”Ÿæˆ
   - æœ¬åœ°æ–‡ä»¶ç®¡ç†
   - åŸºç¡€æœç´¢

2. **é«˜çº§åŠŸèƒ½**ï¼ˆå¯é€‰ï¼‰
   - é…ç½® Gitee AI åå¯ç”¨ RAG
   - é…ç½® Elasticsearch åå¯ç”¨å‘é‡æœç´¢
   - æœªé…ç½®æ—¶é™çº§ä¸ºåŸºç¡€åŠŸèƒ½

3. **ä¼˜ç‚¹**
   - âœ… çµæ´»æ€§é«˜
   - âœ… ç”¨æˆ·å¯é€‰
   - âœ… æ¸è¿›å¼å®ç°

---

## ğŸ’¡ æ¨èå®ç°è·¯å¾„

### ç¬¬ä¸€é˜¶æ®µï¼šMVPï¼ˆæœ€å°å¯è¡Œäº§å“ï¼‰

1. **ä»£ç åˆ†æå™¨**
   ```java
   public class JavaDocAnalyzer {
       // ä½¿ç”¨ PSI API åˆ†æ Spring Boot é¡¹ç›®
       public ProjectDocumentation analyze(Project project) {
           // æ‰«æ @RestController
           // æå– @RequestMapping
           // ç”Ÿæˆæ–‡æ¡£æ¨¡å‹
       }
   }
   ```

2. **æ–‡æ¡£ç”Ÿæˆå™¨**
   ```java
   public class MarkdownGenerator {
       public String generate(ProjectDocumentation doc) {
           // ç”Ÿæˆ Markdown æ ¼å¼
       }
   }
   ```

3. **Action å®ç°**
   ```java
   public class IndexProjectAction extends AnAction {
       @Override
       public void actionPerformed(@NotNull AnActionEvent e) {
           Project project = e.getProject();
           JavaDocAnalyzer analyzer = new JavaDocAnalyzer();
           ProjectDocumentation doc = analyzer.analyze(project);
           MarkdownGenerator generator = new MarkdownGenerator();
           String markdown = generator.generate(doc);
           // ä¿å­˜åˆ°æ–‡ä»¶
       }
   }
   ```

### ç¬¬äºŒé˜¶æ®µï¼šå¢å¼ºæœç´¢

1. **æœ¬åœ°æœç´¢**
   - ä½¿ç”¨ Lucene æˆ–ç®€å•çš„æ–‡æœ¬æœç´¢
   - ä¸éœ€è¦å‘é‡åŒ–

2. **UI å¢å¼º**
   - åœ¨å·¥å…·çª—å£æ˜¾ç¤ºæœç´¢ç»“æœ
   - æ”¯æŒè·³è½¬åˆ°æºä»£ç 

### ç¬¬ä¸‰é˜¶æ®µï¼šAI é›†æˆï¼ˆå¯é€‰ï¼‰

1. **ç›´æ¥è°ƒç”¨ Gitee AI**
   ```java
   public class GiteeAiClient {
       private final String apiKey;
       private final OkHttpClient client;
       
       public String chat(String prompt) {
           // ä½¿ç”¨ OkHttp è°ƒç”¨ Gitee AI API
           Request request = new Request.Builder()
               .url("https://ai.gitee.com/v1/chat/completions")
               .header("Authorization", "Bearer " + apiKey)
               .post(...)
               .build();
           Response response = client.newCall(request).execute();
           return parseResponse(response);
       }
   }
   ```

2. **ç®€å•çš„ RAG**
   - å°†æ–‡æ¡£åˆ†å—å­˜å‚¨
   - æŸ¥è¯¢æ—¶æ‰¾åˆ°ç›¸å…³æ–‡æ¡£
   - æ‹¼æ¥æˆ prompt ç»™ AI

---

## ğŸ“‹ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³ä¿®å¤

1. âœ… æ·»åŠ  Elasticsearch 8.15 ä¾èµ–
2. âœ… åˆ é™¤æ‰€æœ‰ Spring ç›¸å…³æ–‡ä»¶
3. â³ ä¿®å¤ `ElasticsearchVectorStore_8_15.java` ç¼–è¯‘é”™è¯¯
4. â³ ç¡®ä¿é¡¹ç›®å¯ä»¥ç¼–è¯‘é€šè¿‡

### åç»­å¼€å‘

æ ¹æ®æ‚¨çš„éœ€æ±‚é€‰æ‹©ï¼š

**é€‰é¡¹ Aï¼šç®€åŒ–ç‰ˆï¼ˆå¿«é€Ÿå¯ç”¨ï¼‰**
- åªå®ç°ä»£ç åˆ†æå’Œæ–‡æ¡£ç”Ÿæˆ
- 1-2 å¤©å¯å®Œæˆ

**é€‰é¡¹ Bï¼šå®Œæ•´ç‰ˆï¼ˆå« RAGï¼‰**
- è‡ªå·±å®ç° AI è°ƒç”¨
- éœ€è¦ 1-2 å‘¨

**é€‰é¡¹ Cï¼šæš‚åœæ´»æ–‡æ¡£åŠŸèƒ½**
- ä¸“æ³¨äºæ’ä»¶çš„å…¶ä»–åŠŸèƒ½
- åç»­å†å®ç°

---

## ğŸ”§ å½“å‰ä¾èµ–

```gradle
dependencies {
    // Elasticsearch 8.15
    implementation 'co.elastic.clients:elasticsearch-java:8.15.0'
    implementation 'org.elasticsearch.client:elasticsearch-rest-client:8.15.0'
    implementation 'org.apache.httpcomponents:httpclient:4.5.14'
    implementation 'org.apache.httpcomponents:httpcore:4.4.16'
    
    // HTTP å®¢æˆ·ç«¯ï¼ˆAI è°ƒç”¨ï¼‰
    implementation 'com.squareup.okhttp3:okhttp:4.12.0'
}
```

---

## â“ æ‚¨çš„é€‰æ‹©

è¯·å‘Šè¯‰æˆ‘æ‚¨å¸Œæœ›é‡‡ç”¨å“ªä¸ªæ–¹æ¡ˆï¼š

1. **æ–¹æ¡ˆä¸€ï¼ˆç®€åŒ–ç‰ˆï¼‰** - å¿«é€Ÿå®ç°åŸºç¡€æ–‡æ¡£åŠŸèƒ½
2. **æ–¹æ¡ˆäºŒï¼ˆè½»é‡çº§ RAGï¼‰** - è‡ªå·±å®ç° AI è°ƒç”¨å’Œ RAG
3. **æ–¹æ¡ˆä¸‰ï¼ˆæ··åˆæ–¹æ¡ˆï¼‰** - æ¸è¿›å¼å®ç°
4. **æš‚åœæ´»æ–‡æ¡£åŠŸèƒ½** - ä¸“æ³¨äºå…¶ä»–åŠŸèƒ½

æˆ‘ä¼šæ ¹æ®æ‚¨çš„é€‰æ‹©ç»§ç»­å®ç°ï¼ ğŸš€

