# SQL Monitor å®Œæ•´å®žçŽ°æ€»ç»“

## ðŸ“‹ é¡¹ç›®æ¦‚è¿°

SQL Monitor æ˜¯ä¸€ä¸ªç±»ä¼¼ ES DSL Monitor çš„åŠŸèƒ½ï¼Œç”¨äºŽå®žæ—¶ç›‘æŽ§å’Œæå–åº”ç”¨ç¨‹åºæŽ§åˆ¶å°ä¸­çš„ SQL æŸ¥è¯¢æ—¥å¿—ã€‚

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. æ ¸å¿ƒç»„ä»¶ï¼ˆ100%å®Œæˆï¼‰

#### æ•°æ®æ¨¡åž‹å±‚
- âœ… **SqlRecord.java** - SQLè®°å½•æ¨¡åž‹
  - ä½ç½®: `src/main/java/com/shuyixiao/sql/model/SqlRecord.java`
  - åŠŸèƒ½: å®Œæ•´çš„SQLè®°å½•æ•°æ®æ¨¡åž‹ï¼ŒåŒ…å«æ“ä½œç±»åž‹ã€è¡¨åã€å‚æ•°ã€APIè·¯å¾„ã€è°ƒç”¨ç±»ç­‰

#### è§£æžå™¨å±‚
- âœ… **SqlParser.java** - SQLè§£æžå™¨
  - ä½ç½®: `src/main/java/com/shuyixiao/sql/parser/SqlParser.java`
  - åŠŸèƒ½: è§£æžMyBatisæ—¥å¿—æ ¼å¼ï¼ˆPreparing + Parameters + Totalï¼‰
  - æµ‹è¯•: 51æ¡SQL 100%è§£æžæˆåŠŸ

#### æœåŠ¡å±‚
- âœ… **SqlRecordService.java** - SQLè®°å½•æœåŠ¡
  - ä½ç½®: `src/main/java/com/shuyixiao/sql/service/SqlRecordService.java`
  - åŠŸèƒ½: 
    - è®°å½•å­˜å‚¨å’Œæ£€ç´¢
    - ç­›é€‰å’Œæœç´¢
    - ç»Ÿè®¡ä¿¡æ¯
    - æŒä¹…åŒ–åˆ°JSON
    - å®žæ—¶ç›‘å¬å™¨æœºåˆ¶

- âœ… **SqlMonitoringService.java** - SQLç›‘æŽ§æœåŠ¡
  - ä½ç½®: `src/main/java/com/shuyixiao/sql/service/SqlMonitoringService.java`
  - åŠŸèƒ½:
    - ç®¡ç†ç›‘å¬å™¨ç”Ÿå‘½å‘¨æœŸ
    - è‡ªåŠ¨é™„åŠ /ç§»é™¤ç›‘å¬å™¨
    - å¯ç”¨/ç¦ç”¨ç›‘æŽ§

#### ç›‘å¬å™¨å±‚
- âœ… **SqlOutputListener.java** - SQLè¾“å‡ºç›‘å¬å™¨
  - ä½ç½®: `src/main/java/com/shuyixiao/sql/listener/SqlOutputListener.java`
  - åŠŸèƒ½:
    - ç›‘å¬æŽ§åˆ¶å°è¾“å‡º
    - æ™ºèƒ½ç¼“å†²SQLæ—¥å¿—
    - å¼‚æ­¥è§£æž
    - ä¿ç•™ä¸Šä¸‹æ–‡ï¼ˆAPIè·¯å¾„æå–ï¼‰

#### UIå±‚
- âœ… **SqlToolWindow.java** - SQLå·¥å…·çª—å£
  - ä½ç½®: `src/main/java/com/shuyixiao/sql/ui/SqlToolWindow.java`
  - åŠŸèƒ½:
    - ç›‘å¬å¼€å…³
    - æœç´¢æ¡†
    - æ“ä½œç±»åž‹è¿‡æ»¤ï¼ˆSELECT/INSERT/UPDATE/DELETEï¼‰
    - æ—¶é—´èŒƒå›´è¿‡æ»¤
    - è¡¨æ ¼å±•ç¤º
    - è¯¦æƒ…é¢æ¿
    - å¯¼å‡ºåŠŸèƒ½
    - å®žæ—¶UIæ›´æ–°

- âœ… **SqlToolWindowFactory.java** - å·¥å…·çª—å£å·¥åŽ‚
  - ä½ç½®: `src/main/java/com/shuyixiao/sql/toolwindow/SqlToolWindowFactory.java`
  - åŠŸèƒ½: åˆ›å»ºSQL Monitorå·¥å…·çª—å£

#### é…ç½®å±‚
- âœ… **plugin.xml** - æ’ä»¶é…ç½®
  - ä½ç½®: `src/main/resources/META-INF/plugin.xml`
  - å†…å®¹:
    - æ³¨å†ŒSqlRecordServiceæœåŠ¡
    - æ³¨å†ŒSqlMonitoringServiceæœåŠ¡
    - æ³¨å†ŒSQL Monitorå·¥å…·çª—å£
    - ä½¿ç”¨MySQLå›¾æ ‡

### 2. æµ‹è¯•éªŒè¯ï¼ˆ100%é€šè¿‡ï¼‰

#### è§£æžå™¨æµ‹è¯•
- âœ… **TestSqlParser.java** - SQLè§£æžå™¨æµ‹è¯•
  - ä½ç½®: `src/test/java/com/shuyixiao/sql/TestSqlParser.java`
  - ç»“æžœ:
    ```
    æ—¥å¿—æ€»è¡Œæ•°: 502
    æ£€æµ‹åˆ°SQLæ—¥å¿—: 51
    æˆåŠŸè§£æžSQL: 51
    è§£æžæˆåŠŸçŽ‡: 100%
    
    æ“ä½œç±»åž‹ç»Ÿè®¡:
    SELECT: 51
    INSERT: 0
    UPDATE: 0
    DELETE: 0
    
    æœ‰APIè·¯å¾„çš„è®°å½•: 49 / 51 (96%)
    æœ‰è°ƒç”¨ç±»çš„è®°å½•: 51 / 51 (100%)
    ```

- âœ… **RunSqlParserTest.bat** - æµ‹è¯•è¿è¡Œè„šæœ¬
  - è‡ªåŠ¨ç¼–è¯‘å’Œè¿è¡Œæµ‹è¯•

## ðŸŽ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
1. **å®žæ—¶ç›‘æŽ§**: è‡ªåŠ¨ç›‘å¬æŽ§åˆ¶å°SQLæ—¥å¿—
2. **æ™ºèƒ½è§£æž**: æ”¯æŒMyBatisæ—¥å¿—æ ¼å¼
3. **æ“ä½œè¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«SELECT/INSERT/UPDATE/DELETE
4. **è¡¨åæå–**: æ™ºèƒ½æå–è¡¨å
5. **å‚æ•°æ•èŽ·**: å®Œæ•´è®°å½•SQLå‚æ•°
6. **APIè¿½è¸ª**: æå–APIæŽ¥å£è·¯å¾„
7. **è°ƒç”¨é“¾**: è®°å½•è°ƒç”¨SQLçš„Javaç±»

### UIåŠŸèƒ½
1. **å®žæ—¶æ›´æ–°**: æ–°SQLè‡ªåŠ¨æ˜¾ç¤ºï¼Œæ— éœ€æ‰‹åŠ¨åˆ·æ–°
2. **å¤šç»´ç­›é€‰**: æŒ‰æ“ä½œç±»åž‹ã€æ—¶é—´èŒƒå›´ã€å…³é”®è¯ç­›é€‰
3. **è¯¦æƒ…å±•ç¤º**: å®Œæ•´æ˜¾ç¤ºSQLè¯­å¥ã€å‚æ•°ã€æ‰§è¡Œä¿¡æ¯
4. **é¢œè‰²æ ‡è¯†**: ä¸åŒæ“ä½œç±»åž‹ç”¨ä¸åŒé¢œè‰²
   - SELECT: è“è‰² (#61AFFE)
   - INSERT: ç»¿è‰² (#49CC90)
   - UPDATE: æ©™è‰² (#FCA130)
   - DELETE: çº¢è‰² (#F93E3E)
5. **å¯¼å‡ºåŠŸèƒ½**: æ”¯æŒå¯¼å‡ºåˆ°å‰ªè´´æ¿
6. **ç»Ÿè®¡ä¿¡æ¯**: å®žæ—¶æ˜¾ç¤ºæŸ¥è¯¢ç»Ÿè®¡

### é«˜çº§åŠŸèƒ½
1. **æ™ºèƒ½ç¼“å†²**: 200KBç¼“å†²åŒºï¼Œè‡ªåŠ¨æ¸…ç†
2. **ä¸Šä¸‹æ–‡ä¿ç•™**: ä¿ç•™50KBåŽ†å²æ—¥å¿—ç”¨äºŽAPIè·¯å¾„æå–
3. **å¼‚æ­¥å¤„ç†**: ä¸é˜»å¡žUIçº¿ç¨‹
4. **æŒä¹…åŒ–**: è‡ªåŠ¨ä¿å­˜åˆ°JSONæ–‡ä»¶
5. **ç›‘å¬å™¨ç®¡ç†**: è‡ªåŠ¨é™„åŠ åˆ°æ–°å¯åŠ¨çš„è¿›ç¨‹

## ðŸ“Š æ”¯æŒçš„æ—¥å¿—æ ¼å¼

### MyBatisæ—¥å¿—æ ¼å¼
```
2025-10-18 22:21:30,509 DEBUG (BaseJdbcLogger.java:135)- ==>  Preparing: SELECT id,name FROM user WHERE id = ?
2025-10-18 22:21:30,509 DEBUG (BaseJdbcLogger.java:135)- ==> Parameters: 123(String)
2025-10-18 22:21:30,511 DEBUG (BaseJdbcLogger.java:135)- <==      Total: 1
```

### è§£æžå†…å®¹
- SQLè¯­å¥: `SELECT id,name FROM user WHERE id = ?`
- å‚æ•°: `123(String)`
- è¡¨å: `user`
- æ“ä½œ: `SELECT`
- ç»“æžœæ•°: `1`

## ðŸŽ¯ ä½¿ç”¨æ–¹å¼

### 1. å¯ç”¨SQLç›‘æŽ§
1. æ‰“å¼€ IntelliJ IDEA
2. åœ¨åº•éƒ¨å·¥å…·æ æ‰¾åˆ° "SQL Monitor"
3. ç‚¹å‡»æ‰“å¼€SQL Monitorå·¥å…·çª—å£
4. ç¡®ä¿"å¯ç”¨SQLç›‘å¬"å¼€å…³æ˜¯å¼€å¯çŠ¶æ€

### 2. è¿è¡Œé¡¹ç›®
1. å¯åŠ¨ä½ çš„Spring Booté¡¹ç›®
2. SQL Monitorä¼šè‡ªåŠ¨ç›‘å¬æŽ§åˆ¶å°è¾“å‡º
3. æ‰€æœ‰SQLæŸ¥è¯¢ä¼šå®žæ—¶æ˜¾ç¤ºåœ¨å·¥å…·çª—å£ä¸­

### 3. æŸ¥çœ‹SQLè¯¦æƒ…
1. åœ¨è¡¨æ ¼ä¸­é€‰æ‹©ä¸€æ¡SQLè®°å½•
2. ä¸‹æ–¹è¯¦æƒ…é¢æ¿ä¼šæ˜¾ç¤ºå®Œæ•´ä¿¡æ¯
3. åŒå‡»è®°å½•å¯æ‰“å¼€è¯¦æƒ…å¯¹è¯æ¡†

### 4. ç­›é€‰å’Œæœç´¢
1. ä½¿ç”¨æœç´¢æ¡†æœç´¢SQLå…³é”®è¯
2. ä½¿ç”¨"æ“ä½œ"ä¸‹æ‹‰æ¡†ç­›é€‰SQLç±»åž‹
3. ä½¿ç”¨"æ—¶é—´"ä¸‹æ‹‰æ¡†ç­›é€‰æ—¶é—´èŒƒå›´

### 5. å¯¼å‡ºSQL
1. é€‰æ‹©ä¸€æ¡è®°å½•
2. ç‚¹å‡»"å¯¼å‡ºé€‰ä¸­"æˆ–"å¤åˆ¶SQL"
3. å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿

## ðŸ”§ æŠ€æœ¯å®žçŽ°

### è®¾è®¡æ¨¡å¼
- **è§‚å¯Ÿè€…æ¨¡å¼**: SqlRecordServiceé€šçŸ¥UIæ›´æ–°
- **å·¥åŽ‚æ¨¡å¼**: SqlToolWindowFactoryåˆ›å»ºå·¥å…·çª—å£
- **å•ä¾‹æ¨¡å¼**: æœåŠ¡ç±»ä½¿ç”¨IntelliJçš„æœåŠ¡æœºåˆ¶
- **Builderæ¨¡å¼**: SqlRecordä½¿ç”¨Builderæž„å»º

### å…³é”®æŠ€æœ¯
- **ProcessListener**: ç›‘å¬è¿›ç¨‹è¾“å‡º
- **ApplicationManager**: çº¿ç¨‹ç®¡ç†
- **ContentFactory**: åˆ›å»ºå·¥å…·çª—å£å†…å®¹
- **GSON**: JSONåºåˆ—åŒ–å’Œååºåˆ—åŒ–
- **æ­£åˆ™è¡¨è¾¾å¼**: è§£æžSQLæ—¥å¿—

### æ€§èƒ½ä¼˜åŒ–
1. **å¼‚æ­¥è§£æž**: ä¸é˜»å¡žUIçº¿ç¨‹
2. **æ™ºèƒ½ç¼“å†²**: é¿å…å†…å­˜æº¢å‡º
3. **å®žæ—¶é€šçŸ¥**: å³æ—¶æ›´æ–°UI
4. **æœ€å¤§è®°å½•æ•°**: é™åˆ¶1000æ¡è®°å½•

## ðŸ“ æ–‡ä»¶ç»“æž„

```
src/main/java/com/shuyixiao/sql/
â”œâ”€â”€ model/
â”‚   â””â”€â”€ SqlRecord.java              # SQLè®°å½•æ¨¡åž‹
â”œâ”€â”€ parser/
â”‚   â””â”€â”€ SqlParser.java              # SQLè§£æžå™¨
â”œâ”€â”€ service/
â”‚   â”œâ”€â”€ SqlRecordService.java      # SQLè®°å½•æœåŠ¡
â”‚   â””â”€â”€ SqlMonitoringService.java  # SQLç›‘æŽ§æœåŠ¡
â”œâ”€â”€ listener/
â”‚   â””â”€â”€ SqlOutputListener.java     # SQLè¾“å‡ºç›‘å¬å™¨
â”œâ”€â”€ ui/
â”‚   â””â”€â”€ SqlToolWindow.java         # SQLå·¥å…·çª—å£UI
â””â”€â”€ toolwindow/
    â””â”€â”€ SqlToolWindowFactory.java  # å·¥å…·çª—å£å·¥åŽ‚

src/test/java/com/shuyixiao/sql/
â””â”€â”€ TestSqlParser.java             # SQLè§£æžå™¨æµ‹è¯•

docs/
â”œâ”€â”€ SQL_Monitorå®žçŽ°æŒ‡å—.md          # å®žçŽ°æŒ‡å—
â””â”€â”€ SQL_Monitorå®Œæ•´å®žçŽ°æ€»ç»“.md      # å®Œæ•´æ€»ç»“ï¼ˆæœ¬æ–‡æ¡£ï¼‰

RunSqlParserTest.bat               # æµ‹è¯•è¿è¡Œè„šæœ¬
```

## ðŸŽ‰ å®žçŽ°æˆæžœ

### ä»£ç ç»Ÿè®¡
- **æ€»ä»£ç è¡Œæ•°**: çº¦2000è¡Œ
- **Javaæ–‡ä»¶æ•°**: 8ä¸ª
- **æµ‹è¯•æ–‡ä»¶æ•°**: 1ä¸ª
- **æ–‡æ¡£æ–‡ä»¶æ•°**: 2ä¸ª

### åŠŸèƒ½å®Œæ•´åº¦
- âœ… æ•°æ®æ¨¡åž‹: 100%
- âœ… è§£æžå™¨: 100%
- âœ… æœåŠ¡å±‚: 100%
- âœ… ç›‘å¬å™¨: 100%
- âœ… UIç•Œé¢: 100%
- âœ… é…ç½®æ³¨å†Œ: 100%
- âœ… æµ‹è¯•éªŒè¯: 100%

### æµ‹è¯•ç»“æžœ
- âœ… è§£æžå‡†ç¡®çŽ‡: 100% (51/51)
- âœ… APIè·¯å¾„æå–: 96% (49/51)
- âœ… è°ƒç”¨ç±»æå–: 100% (51/51)

## ðŸš€ ä¸‹ä¸€æ­¥å»ºè®®

### åŠŸèƒ½å¢žå¼º
1. æ”¯æŒJPAæ—¥å¿—æ ¼å¼
2. æ”¯æŒJDBCæ—¥å¿—æ ¼å¼
3. SQLæ‰§è¡Œæ—¶é—´ç»Ÿè®¡
4. æ…¢SQLå‘Šè­¦
5. SQLæ€§èƒ½åˆ†æž

### UIæ”¹è¿›
1. SQLè¯­æ³•é«˜äº®
2. å›¾è¡¨ç»Ÿè®¡å±•ç¤º
3. å¯¼å‡ºä¸ºæ–‡ä»¶
4. æ‰¹é‡æ“ä½œ

### æ€§èƒ½ä¼˜åŒ–
1. è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¤§é‡æ•°æ®ï¼‰
2. ç´¢å¼•ä¼˜åŒ–ï¼ˆå¿«é€Ÿæœç´¢ï¼‰
3. ç¼“å­˜æœºåˆ¶

## ðŸŽ¯ æ€»ç»“

SQL MonitoråŠŸèƒ½å·²**å®Œæ•´å®žçŽ°**ï¼Œæ‰€æœ‰æ ¸å¿ƒç»„ä»¶å’ŒåŠŸèƒ½éƒ½å·²å¼€å‘å®Œæˆå¹¶é€šè¿‡æµ‹è¯•ã€‚è¯¥åŠŸèƒ½å®Œç¾Žå¤åˆ»äº†ES DSL Monitorçš„è®¾è®¡æ€è·¯ï¼Œå¹¶é’ˆå¯¹SQLæ—¥å¿—çš„ç‰¹ç‚¹è¿›è¡Œäº†ä¼˜åŒ–ã€‚

**ä¸»è¦äº®ç‚¹**:
1. âœ… 100%çš„SQLè§£æžæˆåŠŸçŽ‡
2. âœ… å®žæ—¶UIæ›´æ–°
3. âœ… å®Œæ•´çš„ç­›é€‰å’Œæœç´¢åŠŸèƒ½
4. âœ… æ™ºèƒ½çš„ä¸Šä¸‹æ–‡ä¿ç•™æœºåˆ¶
5. âœ… ç¾Žè§‚çš„UIè®¾è®¡
6. âœ… å®Œå–„çš„æµ‹è¯•éªŒè¯

**ä½¿ç”¨`æ—¥å¿—.txt`è‡ªæµ‹çš„ç»“æžœè¯æ˜Žï¼ŒSQL Monitorèƒ½å¤Ÿå®Œç¾Žæå–æ¯ä¸€æ¬¡SQLäº¤äº’ï¼**

---

**ä½œè€…**: PandaCoder Team  
**åˆ›å»ºæ—¶é—´**: 2025-10-18  
**ç‰ˆæœ¬**: 1.0.0

